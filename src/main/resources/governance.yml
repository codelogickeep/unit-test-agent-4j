enabled: true
policy:
  # Rule: Allow reading all files in src/
  # Fix: Use safe map access for 'path' and allow query-based access (KnowledgeBase)
  - resource: "file-read"
    action: "ALLOW"
    condition: "(['path'] != null && ['path'].startsWith('src/')) || ['query'] != null"
    
  # Rule: Only allow writing to src/test/java/ (Core Security Policy)
  - resource: "file-write"
    action: "ALLOW"
    condition: "['path'] != null && ['path'].contains('/src/test/java/')"
    
  # Rule: Only allow executing mvn test command with safe class names (Allow inner classes $, methods #, wildcards *)
  # Fix: Allow null testClassName (for compileProject) or valid class name
  - resource: "shell-exec"
    action: "ALLOW"
    condition: "(['testClassName'] == null) || ['testClassName'].matches('[a-zA-Z0-9_$.#*-]+')"
